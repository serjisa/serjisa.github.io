<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Транскриптомика | sergey isaev</title> <meta name="author" content="Sergey Isaev"> <meta name="description" content="Sergey Isaev | Personal webpage with CV, short biography and contcat information "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://serjisa.github.io/hse.2023/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">sergey isaev</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">me</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <h1 id="блок-транскриптомика"><strong>Блок «Транскриптомика»</strong></h1> <p>Факультет биологии и биотехнологии ВШЭ / Факультет компьютерных наук ВШЭ / Осень 2023</p> <h3 id="программа-курса">Программа курса</h3> <p>Моя часть курса состоит из 6 занятий. Все материалы будут выкладываться на этом сайте по ходу прохождения материала.</p> <table> <thead> <tr> <th>Дата</th> <th>Тема</th> <th>Слайды</th> <th>Код</th> <th>Видео</th> </tr> </thead> <tbody> <tr> <td>18.09</td> <td>Экспериментальная процедура RNA-Seq и подсчёт экспрессий</td> <td><a href="https://docs.google.com/presentation/d/1TdyfIom5pl0OmZFuh5Wq2szUZymX9Ll7Nm25BeFZVSg/edit?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td> </td> <td><a href="https://www.youtube.com/watch?v=3McEwlOcEOs" rel="external nofollow noopener" target="_blank">Ссылка</a></td> </tr> <tr> <td>25.09</td> <td>Распределения в омиксных данных и дифференциальная экспрессия</td> <td><a href="https://docs.google.com/presentation/d/16peLYZS2pHWPpcPceUzApGDO4vyuW4uFg2xfez0t_fs/edit?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td> </td> <td><a href="https://www.youtube.com/watch?v=OCYZ_bAvmsE" rel="external nofollow noopener" target="_blank">Ссылка</a></td> </tr> <tr> <td>02.10</td> <td>Функциональный анализ RNA-Seq. Практикум</td> <td><a href="https://docs.google.com/presentation/d/1rJzn3TN3gqjzlkANViSmp9YvOSVftnsTQBWOHLXNYjg/edit?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td><a href="https://colab.research.google.com/drive/1MPHrBa0s_yjEGyRSyD9afpzkc-XNGwJK?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td><a href="https://www.youtube.com/watch?v=Y3FZGQHF4fU" rel="external nofollow noopener" target="_blank">Ссылка</a></td> </tr> <tr> <td>09.10</td> <td>Экспериментальная процедура и анализ scRNA-Seq</td> <td><a href="https://docs.google.com/presentation/d/1UBlarrl2Ez9HJHNwtZuX1knrbxeeitc0tb6bn9Ma5kU/edit?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td> </td> <td><a href="https://www.youtube.com/watch?v=ufUjJhsmzEY" rel="external nofollow noopener" target="_blank">Ссылка</a></td> </tr> <tr> <td>16.10</td> <td>Практикум по анализу scRNA-Seq</td> <td><a href="https://docs.google.com/presentation/d/1hdT_d-Kq4oNafBwfA11bmMnCVOmr_QuDdWQ-WXObhqg/edit?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td><a href="https://colab.research.google.com/drive/1lww-dEi53__qJ0IIL8zqUPEMQIAdY80_?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td><a href="https://www.youtube.com/watch?v=VzIptY6_74s" rel="external nofollow noopener" target="_blank">Ссылка</a></td> </tr> <tr> <td>23.10</td> <td>Ribo-seq / Бисульфитное секвенирование РНК / CLIP-Seq</td> <td><a href="https://docs.google.com/presentation/d/1dr19g9IekcW8_HNz-euy1kmOKapLQd2mfrssPNTnS2c/edit?usp=sharing" rel="external nofollow noopener" target="_blank">Ссылка</a></td> <td> </td> <td><a href="https://www.youtube.com/watch?v=QW7hTT8z-Cg" rel="external nofollow noopener" target="_blank">Ссылка</a></td> </tr> </tbody> </table> <p><br></p> <h3 id="условия-зачёта">Условия зачёта</h3> <p>Зачёт по курсу ставится как среднее арифметическое домашних заданий. По моему блоку будут три домашних задания, каждое из которых оценивается максимально в 10 баллов. При сдаче домашнего задания до <strong>1 декабря</strong> есть возможность получить фидбэк и повысить собственную оценку при условия исправления. Жёсткий дедлайн по домашним заданиям — <strong>15 декабря</strong>. Разбалловка для студентов магистратуры ФКН ВШЭ и бакалавров ФББ ВШЭ разная! В скобках первая оценка указана для бакалавров, а вторая — для магистров. Суммарный балл за задание — это <code class="language-plaintext highlighter-rouge">min(10, ваш_балл)</code>.</p> <p>Любое обнаружение плагиата в работе — это 0 за домашнее задание (без права переделывания даже если задание было сдано до мягкого дедлайна) и тому, кто списал, и тому, кто дал списать. Форма отчёта — это заполненная <a href="https://forms.gle/3PywwV8kywn1KyJk8" rel="external nofollow noopener" target="_blank">форма</a> со ссылкой на Google Drive с вашей домашкой. Одно задание — одна заполненная форма.</p> <h4 id="задание-по-блоку-bulk-rna-seq"><strong>Задание по блоку «Bulk RNA-Seq»</strong></h4> <ol> <li>(2 / 1) Загрузите прочтения по ссылкам, указанным в конце задания. Запустите контроль качества прочтений на каждом образце индивидуально. При помощи программы MultiQC аггрегируйте результаты по всем образцам и словесно опишите качество данных, с которыми вам предстоит работать.</li> <li>(2 / 1) Подготовьте референсный транскриптом для <code class="language-plaintext highlighter-rouge">kallisto</code> (с геномом человека) и проведите подсчёт экспрессии на уровень транскриптов. Откуда вы взяли референсный транскриптом? Не забудьте, что для следующих шагов вам потребуется таблица с соответствием генов транскриптам, также вам пригодится понимание того, какие конкретно гены являются белок-кодирующими (дифференциальную экспрессию будем выполнять именно на них).</li> <li>(6 / 5) Попробуйте самостоятельно реализовать EM-алгоритм для подсчёта экспрессий (в упрощённом виде). Транскрипты имеют вид ABC, ABCD, ABDG, BFQZ и так далее. Гарантируется, что каждый из транскриптов имеет длину более пяти букв. Каждое прочтение состоит только из двух букв, гарантируется, что существует хотя бы одно вхождение сочетания из этих двух букв в какой-либо из транскриптов. Вероятность порождения транскриптом рида прямо пропорциональна длине транскрипта - 1. Напишите функцию, которая будет на вход принимать (а) лист из транскриптов и (б) лист из ридов и которая будет возвращать оценённые пропорции транскриптов. Сравните результаты получившейся функции с kallisto (для этого придумайте, как можно сгенерировать прочтения так, чтобы это было максимально похоже на то, с чем вы работаете по условию задачи). Сходятся ли результаты в вашем примере?</li> <li>(1 / 0.5) С использованием <code class="language-plaintext highlighter-rouge">tximport</code> загрузите в <code class="language-plaintext highlighter-rouge">DESeq2</code> результат обсчёта экспрессий из пункта (2) и проведите дифференциальную экспрессию между образцами из групп <strong>A</strong> и <strong>B</strong> на уровне генов.</li> <li>(6 / 5) Попробуйте реализовать альтернативу <code class="language-plaintext highlighter-rouge">tximport</code> для библиотеки <code class="language-plaintext highlighter-rouge">PyDESeq2</code>. Покажите, что результаты сходятся с аналогичными в R.</li> <li>(2 / 1) Проведите анализ самосогласованности данных при помощи PCA. Выбросите ненужные образцы и проведите анализ дифференциальной ещё раз. Влияет ли наличие аутлаеров на результат дифференциальной экспрессии? Выводы подкрепите графически.</li> <li>(2 / 1.5) Проведите функциональный анализ полученных данных (feel free в выборе инструментов). Какую основную разницу между образцами вы видите?</li> <li>(1 / 1) Воспроизводятся ли выводы, которые вы сделали в результате шага (7), если вместо загрузки через <code class="language-plaintext highlighter-rouge">tximport</code> просто просуммировать каунты <code class="language-plaintext highlighter-rouge">kallisto</code> на ген и округлить значения?</li> </ol> <table> <thead> <tr> <th>Образец</th> <th>Группа</th> <th>Прямые прочтения</th> <th>Обратные прочтения</th> </tr> </thead> <tbody> <tr> <td>B1</td> <td>B</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/003/SRR6410613/SRR6410613_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/003/SRR6410613/SRR6410613_2.fastq.gz</td> </tr> <tr> <td>B2</td> <td>B</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/004/SRR6410614/SRR6410614_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/004/SRR6410614/SRR6410614_2.fastq.gz</td> </tr> <tr> <td>B3</td> <td>B</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/001/SRR6410611/SRR6410611_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/001/SRR6410611/SRR6410611_2.fastq.gz</td> </tr> <tr> <td>B4</td> <td>B</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/002/SRR6410612/SRR6410612_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/002/SRR6410612/SRR6410612_2.fastq.gz</td> </tr> <tr> <td>B5</td> <td>B</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/005/SRR6410615/SRR6410615_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/005/SRR6410615/SRR6410615_2.fastq.gz</td> </tr> <tr> <td>A1</td> <td>A</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/005/SRR6410605/SRR6410605_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/005/SRR6410605/SRR6410605_2.fastq.gz</td> </tr> <tr> <td>A2</td> <td>A</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/006/SRR6410606/SRR6410606_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/006/SRR6410606/SRR6410606_2.fastq.gz</td> </tr> <tr> <td>A3</td> <td>A</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/003/SRR6410603/SRR6410603_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/003/SRR6410603/SRR6410603_2.fastq.gz</td> </tr> <tr> <td>A4</td> <td>A</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/004/SRR6410604/SRR6410604_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/004/SRR6410604/SRR6410604_2.fastq.gz</td> </tr> <tr> <td>A5</td> <td>A</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/009/SRR6410609/SRR6410609_1.fastq.gz</td> <td>ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR641/009/SRR6410609/SRR6410609_2.fastq.gz</td> </tr> </tbody> </table> <h4 id="задание-по-блоку-scrna-seq"><strong>Задание по блоку «scRNA-Seq»</strong></h4> <ol> <li>(2 / 2) Завершите анализ датасета с семинара. В результате вы должны иметь несколько представлений сниженной размерности (PCA / t-SNE / UMAP / ForceAtlas2 / … — на ваш выбор), которая будет сопровождаться окраской по кластерам.</li> <li>(4 / 3) Попробуйте реализовать NMF / VAE (без использования пакета <code class="language-plaintext highlighter-rouge">scvi-tools</code>) / LDA или иные «нетривиальные» способы снижения размерности. Сравните кластеризацию, которая у вас получилась, с той, что была получена при помощи графа, построенного на PCA. Какая разница? Как можно её количественно оценить?</li> <li>(3 / 2) Есть ли у вас кластера, которые выбиваются по чисто техническим характеристикам: числу UMI на клетку, числу генов на клетку, проценту митохондриальной экспрессии? Есть ли кластера с высоким значением doublet score? Если есть, то как лучше с ними поступить? Достоверны ли различия между кластером, который вы выбрали, и остальными кластерами?</li> <li>(3 / 2) Проаннотируйте датасет при помощи <a href="https://azimuth.hubmapconsortium.org" rel="external nofollow noopener" target="_blank">Azimuth</a> и <a href="https://github.com/potulabe/symphonypy" rel="external nofollow noopener" target="_blank">Symphony</a>. Сравните полученные аннотации и выберите ту, которая, на ваш взгляд, получилась самой разумной. В обоих случаях используйте публично доступные референсы.</li> <li>(2 / 1) Попробуйте получить экспрессионные подписи для каждого из типов клеток — для этого выберите (с использованием порогов по FDR и logFC) топ маркерных генов, а после этого проверьте специфичность на этом жа датасете при помощи функции <code class="language-plaintext highlighter-rouge">sc.tl.score_genes()</code>.</li> </ol> <h4 id="задание-по-блоку-ribo-seq"><strong>Задание по блоку «Ribo-seq»</strong></h4> <p>Загрузите файл (Google Drive ID: <code class="language-plaintext highlighter-rouge">1iqYLFVKySREVm5Kn5NagMeHaDi-dVLcj</code>, файл <code class="language-plaintext highlighter-rouge">01. RiboSeq_RNASeq_HCC_counts.tsv</code>), в котором содержится матрица каунтов результатов Ribo-Seq и RNA-Seq экспериментов больных гепатоцеллюлярной карциномой. Матрица каунтов была получена стандартным воркфлоу STAR. На каждого пациента приходится 4 столбца в таблице (RNA-Seq нормы и опухоли, Ribo-Seq нормы и опухоли), записанные в виде <code class="language-plaintext highlighter-rouge">sample_number-tissue_type-experiment</code>.</p> <ol> <li>(2 / 2) Для каждого гена найдите коэффициент корреляции числа каунтов между экспериментами RNA-Seq и Ribo-Seq. Какую корреляцию вы выберете — Пирсона или Спирмена? Обратите внимание, что перед вами не нормированные на глубину библиотеки каунты, учтите это при анализе.</li> <li>(2 / 2) Постройте гистограмму распределения этих коэффициентов корреляции. Для каких генов корреляция самая высокая, а для каких — самая низкая? Как вы можете это объяснить?</li> <li>(3 / 3) Проанализируйте распределение каунтов Ribo-seq: постройте зависимость дисперсии от среднего. Похоже ли это на NB-распределение? Если нет, то на какое похоже? Если да, то какие статистические тесты можно использовать для подтверждения того, что перед вами NB-распределение? Проведите такую оценку.</li> <li>(3 / 3) Найдите дифференциально экспрессированные гены по RNA-Seq между нормой и опухолью. Для этого можете использовать DESeq2 или edgeR. Постройте volcano plot. То же самое сделайте и для Ribo-Seq эксперимента. Совпадают ли результаты дифференциальной экспрессии? Какие гены оказались значимо различны по экспрессии в одном случае, а какие — в другом? Проведите похожий анализ, только с поиском генов с разницей в эффективности трансляции (<code class="language-plaintext highlighter-rouge">~ method + condition + method:condition</code>). Что вы скажете о наборе генов, который вы получили этим методом? Выводы подкрепите графиками.</li> </ol> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Sergey Isaev. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: November 24, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>